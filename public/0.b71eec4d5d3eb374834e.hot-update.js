webpackHotUpdate(0,{

/***/ 101:
/* no static exports found */
/* all exports used */
/*!**********************************!*\
  !*** ./frontend/actions/util.js ***!
  \**********************************/
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DEFAULT_HEADERS = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; // Helper functions\n\n\nexports.safeWrap = safeWrap;\nexports.fetchHelper = fetchHelper;\nexports.getAPIToken = getAPIToken;\nexports.deleteLocalData = deleteLocalData;\nexports.uploadUserImage = uploadUserImage;\nexports.updateUserImage = updateUserImage;\nexports.uploadEventImage = uploadEventImage;\nexports.updateEventImage = updateEventImage;\n\nvar _loading = __webpack_require__(/*! ./loading */ 116);\n\nvar _types = __webpack_require__(/*! ./types */ 66);\n\nvar types = _interopRequireWildcard(_types);\n\nvar _isomorphicFetch = __webpack_require__(/*! isomorphic-fetch */ 918);\n\nvar _isomorphicFetch2 = _interopRequireDefault(_isomorphicFetch);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction safeWrap(json, okCallback, dispatch) {\n  if (json.status === 'ok') {\n    if (json.msg) {\n      (0, _loading.messageWrap)(dispatch, json.msg);\n    }\n    return okCallback();\n  } else {\n    (0, _loading.errorWrap)(dispatch, json.msg);\n  }\n}\n\nfunction fetchHelper(route, apiToken) {\n  var obj = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (!apiToken) {\n    return (0, _isomorphicFetch2.default)(route, obj);\n  }\n  var headers = { 'Authorization': 'Bearer ' + apiToken };\n  obj.headers = Object.assign({}, obj.headers || {}, headers);\n  return (0, _isomorphicFetch2.default)(route, obj);\n}\n\nfunction getAPIToken(getState) {\n  return getState().user && getState().user.token ? getState().user.token : null;\n}\n\nfunction deleteLocalData(type, id) {\n  return {\n    type: types.DELETE_DATA_LOCALLY,\n    data_type: type,\n    id: id\n  };\n}\n\nvar DEFAULT_HEADERS = exports.DEFAULT_HEADERS = {\n  'Accept': 'application/json',\n  'Content-Type': 'application/json'\n};\n\nfunction uploadUserImage(data) {\n  return function (dispatch, getState) {\n    var _getState = getState(),\n        user = _getState.user;\n\n    if (user) {\n      dispatch((0, _loading.showModalLoader)());\n      var packagedData = new FormData();\n      console.log(\"here\");\n      packagedData.append(\"image\", data[\"file\"]);\n      fetchHelper('/api/users/uploadImage/' + user._id, getAPIToken(getState), {\n        method: 'POST',\n        body: packagedData\n      }).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        return safeWrap(json, function () {\n          dispatch(updateUserImage(json.user));\n        }, dispatch);\n      }).then(function () {\n        return dispatch((0, _loading.hideModalLoader)());\n      });\n    } else {\n      // unexpected error\n      (0, _loading.errorWrap)(dispatch, \"User not found in state (unexpected error)\");\n    }\n  };\n}\n\n// timehack - tbh we don't need user param\nfunction updateUserImage(user) {\n  var curTime = new Date().getTime();\n  var newUser = _extends({}, user, { image: user.image + '?' + curTime }); // but deep copy\n  return {\n    type: types.USER_UPDATE,\n    user: newUser\n  };\n}\n\nfunction uploadEventImage(data, id) {\n  return function (dispatch, getState) {\n    dispatch((0, _loading.showModalLoader)());\n    var packagedData = new FormData();\n    packagedData.append(\"image\", data[\"file\"]);\n    fetchHelper('/api/events/uploadImage/' + id, getAPIToken(getState), {\n      method: 'POST',\n      body: packagedData\n    }).then(function (response) {\n      return response.json();\n    }).then(function (json) {\n      return safeWrap(json, function () {\n        dispatch(updateEventImage(json.event));\n      }, dispatch);\n    }).then(function () {\n      return dispatch((0, _loading.hideModalLoader)());\n    });\n  };\n}\n\n// assume ID is in array of events\nfunction updateEventImage(event) {\n  var curTime = new Date().getTime();\n  var newEvent = _extends({}, event, { image: event.image + '?' + curTime }); // but deep copy\n  return {\n    type: types.RECEIVE_MORE_EVENTS,\n    events: [newEvent]\n  };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2Zyb250ZW5kL2FjdGlvbnMvdXRpbC5qcz80MzZhIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEhlbHBlciBmdW5jdGlvbnNcbmltcG9ydCB7IG1lc3NhZ2VXcmFwLCBlcnJvcldyYXAsIHNob3dNb2RhbExvYWRlciwgaGlkZU1vZGFsTG9hZGVyLCBsb2FkaW5nLCBzdG9wTG9hZGluZyB9IGZyb20gJy4vbG9hZGluZyc7XG5pbXBvcnQgKiBhcyB0eXBlcyBmcm9tICcuL3R5cGVzJztcbmltcG9ydCBmZXRjaCBmcm9tICdpc29tb3JwaGljLWZldGNoJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNhZmVXcmFwKGpzb24sIG9rQ2FsbGJhY2ssIGRpc3BhdGNoKSB7XG4gIGlmIChqc29uLnN0YXR1cyA9PT0gJ29rJykge1xuICAgIGlmIChqc29uLm1zZykge1xuICAgICAgbWVzc2FnZVdyYXAoZGlzcGF0Y2gsIGpzb24ubXNnKTtcbiAgICB9XG4gICAgcmV0dXJuIG9rQ2FsbGJhY2soKTtcbiAgfSBlbHNlIHtcbiAgICBlcnJvcldyYXAoZGlzcGF0Y2gsIGpzb24ubXNnKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmV0Y2hIZWxwZXIoIHJvdXRlLCBhcGlUb2tlbiwgb2JqID0ge30gKSB7XG4gIGlmICghYXBpVG9rZW4pIHtcbiAgICByZXR1cm4gZmV0Y2gocm91dGUsIG9iaik7XG4gIH1cbiAgbGV0IGhlYWRlcnMgPSB7J0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBhcGlUb2tlbn07XG4gIG9iai5oZWFkZXJzID0gT2JqZWN0LmFzc2lnbih7fSwgb2JqLmhlYWRlcnMgfHwge30sIGhlYWRlcnMpO1xuICByZXR1cm4gZmV0Y2gocm91dGUsIG9iailcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFQSVRva2VuKCBnZXRTdGF0ZSApIHtcbiAgcmV0dXJuIGdldFN0YXRlKCkudXNlciAmJiBnZXRTdGF0ZSgpLnVzZXIudG9rZW4gPyBnZXRTdGF0ZSgpLnVzZXIudG9rZW4gOiBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlTG9jYWxEYXRhKHR5cGUsIGlkKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogdHlwZXMuREVMRVRFX0RBVEFfTE9DQUxMWSxcbiAgICBkYXRhX3R5cGU6IHR5cGUsXG4gICAgaWQ6IGlkXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfSEVBREVSUyA9IHtcbiAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVwbG9hZFVzZXJJbWFnZShkYXRhKSB7XG4gIHJldHVybiAoZGlzcGF0Y2gsIGdldFN0YXRlKSA9PiB7XG4gICAgY29uc3QgeyB1c2VyIH0gPSBnZXRTdGF0ZSgpO1xuICAgIGlmICh1c2VyKSB7XG4gICAgICBkaXNwYXRjaChzaG93TW9kYWxMb2FkZXIoKSk7XG4gICAgICBsZXQgcGFja2FnZWREYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICBjb25zb2xlLmxvZyhcImhlcmVcIik7XG4gICAgICBwYWNrYWdlZERhdGEuYXBwZW5kKFwiaW1hZ2VcIiwgZGF0YVtcImZpbGVcIl0pO1xuICAgICAgZmV0Y2hIZWxwZXIoYC9hcGkvdXNlcnMvdXBsb2FkSW1hZ2UvJHt1c2VyLl9pZH1gLCBnZXRBUElUb2tlbihnZXRTdGF0ZSksIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IHBhY2thZ2VkRGF0YVxuICAgICAgfSlcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKVxuXHQudGhlbihqc29uID0+IHNhZmVXcmFwKGpzb24sICgpID0+IHtcblx0ICBkaXNwYXRjaCh1cGRhdGVVc2VySW1hZ2UoanNvbi51c2VyKSk7XG5cdH0sIGRpc3BhdGNoKSlcblx0LnRoZW4oKCkgPT4gZGlzcGF0Y2goaGlkZU1vZGFsTG9hZGVyKCkpKTtcbiAgICB9IGVsc2UgeyAvLyB1bmV4cGVjdGVkIGVycm9yXG4gICAgICBlcnJvcldyYXAoZGlzcGF0Y2gsIFwiVXNlciBub3QgZm91bmQgaW4gc3RhdGUgKHVuZXhwZWN0ZWQgZXJyb3IpXCIpO1xuICAgIH1cbiAgfVxufVxuXG4vLyB0aW1laGFjayAtIHRiaCB3ZSBkb24ndCBuZWVkIHVzZXIgcGFyYW1cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVVc2VySW1hZ2UodXNlcikge1xuICBjb25zdCBjdXJUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gIGNvbnN0IG5ld1VzZXIgPSB7IC4uLnVzZXIsIGltYWdlOiBgJHt1c2VyLmltYWdlfT8ke2N1clRpbWV9YCB9OyAvLyBidXQgZGVlcCBjb3B5XG4gIHJldHVybiB7XG4gICAgdHlwZTogdHlwZXMuVVNFUl9VUERBVEUsXG4gICAgdXNlcjogbmV3VXNlclxuICB9XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHVwbG9hZEV2ZW50SW1hZ2UoZGF0YSwgaWQpIHtcbiAgcmV0dXJuIChkaXNwYXRjaCwgZ2V0U3RhdGUpID0+IHtcbiAgICBkaXNwYXRjaChzaG93TW9kYWxMb2FkZXIoKSk7XG4gICAgbGV0IHBhY2thZ2VkRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgIHBhY2thZ2VkRGF0YS5hcHBlbmQoXCJpbWFnZVwiLCBkYXRhW1wiZmlsZVwiXSk7XG4gICAgZmV0Y2hIZWxwZXIoYC9hcGkvZXZlbnRzL3VwbG9hZEltYWdlLyR7aWR9YCwgZ2V0QVBJVG9rZW4oZ2V0U3RhdGUpLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGJvZHk6IHBhY2thZ2VkRGF0YVxuICAgIH0pXG4gICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgICAudGhlbihqc29uID0+IHNhZmVXcmFwKGpzb24sICgpID0+IHtcblx0ZGlzcGF0Y2godXBkYXRlRXZlbnRJbWFnZShqc29uLmV2ZW50KSk7XG4gICAgICB9LCBkaXNwYXRjaCkpXG4gICAgICAudGhlbigoKSA9PiBkaXNwYXRjaChoaWRlTW9kYWxMb2FkZXIoKSkpO1xuICB9XG59XG5cbi8vIGFzc3VtZSBJRCBpcyBpbiBhcnJheSBvZiBldmVudHNcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVFdmVudEltYWdlKGV2ZW50KSB7XG4gIGNvbnN0IGN1clRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgY29uc3QgbmV3RXZlbnQgPSB7IC4uLmV2ZW50LCBpbWFnZTogYCR7ZXZlbnQuaW1hZ2V9PyR7Y3VyVGltZX1gIH07IC8vIGJ1dCBkZWVwIGNvcHlcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiB0eXBlcy5SRUNFSVZFX01PUkVfRVZFTlRTLFxuICAgIGV2ZW50czogW25ld0V2ZW50XVxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZnJvbnRlbmQvYWN0aW9ucy91dGlsLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFXQTtBQVNBO0FBSUE7QUFhQTtBQXdCQTtBQVVBO0FBa0JBO0FBQ0E7QUE5RkE7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUdBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///101\n");

/***/ })

})